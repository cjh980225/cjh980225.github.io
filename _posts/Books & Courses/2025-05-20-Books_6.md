---

title: "[ì´ê²ƒì´ ë°ì´í„° ë¶„ì„ì´ë‹¤] ë¯¸ë˜ì— ë³¼ ì˜í™”ì˜ í‰ì  ì˜ˆì¸¡í•˜ê¸°"

categories: Books&Courses

tags: [Book, ì´ê²ƒì´_ë°ì´í„°_ë¶„ì„ì´ë‹¤, pandas, visualization, analysis]

---

# ë¯¸ë˜ì— ë³¼ ì˜í™”ì˜ í‰ì  ì˜ˆì¸¡í•˜ê¸°

## íƒìƒ‰ : MovieLens ë°ì´í„° ì‚´í´ë³´ê¸° 

|ë°ì´í„°ì…‹|í”¼ì²˜|
|-|-|
|rating ë°ì´í„°|user_id(ìœ ì € ë²ˆí˜¸)|
||movie_id(ì˜í™” ë²ˆí˜¸)|
||rating(ì ìˆ˜)|
||time(ë°ì´í„° ë“±ë¡ ì‹œê°„)|
|movie ë°ì´í„°|movie_id(ì˜í™” ë²ˆí˜¸)|
||title(ì˜í™” ì œëª©)|
||genre(ì¥ë¥´)|
|user ë°ì´í„°|user_id(ìœ ì € ë²ˆí˜¸)|
||gender(ì„±ë³„)|
||age(ë‚˜ì´)|
||occupation(ì§ì—… - ê°œì¸ì •ë³´1)|
||zipcode(ì£¼ì†Œ ì½”ë“œ - ê°œì¸ì •ë³´2)|


ğŸ” MovieLens ë°ì´í„°ì…‹ì˜ ê¸°ë³¸ ì •ë³´ êµ¬í•˜ê¸° 


```python
# -*- coding : utf-8 -*-
%matplotlib inline 

import time 
import operator 

import pandas as pd 
import numpy as np 
import matplotlib.pyplot as plt 
import seaborn as sns 

rating_file_path = "./data/ml-1m/ratings.dat"
movie_file_path = "./data/ml-1m/movies.dat"
user_file_path = "./data/ml-1m/users.dat"

rating_data = pd.read_csv(rating_file_path, 
                          names=['user_id', 'movie_id', 'rating', 'time'], 
                          delimiter='::', 
                          engine='python', 
                          encoding='latin1')

movie_data = pd.read_csv(movie_file_path, 
                         names=['movie_id', 'title', 'genre'], 
                         delimiter='::', 
                         engine='python', 
                         encoding='latin1')

user_data = pd.read_csv(user_file_path, 
                        names=['user_id', 'gender', 'age', 'occupation', 'zipcode'], 
                        delimiter='::', 
                        engine='python', 
                        encoding='latin1')
```


```python
rating_data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>661</td>
      <td>3</td>
      <td>978302109</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>914</td>
      <td>3</td>
      <td>978301968</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3408</td>
      <td>4</td>
      <td>978300275</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2355</td>
      <td>5</td>
      <td>978824291</td>
    </tr>
  </tbody>
</table>
</div>




```python
movie_data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>movie_id</th>
      <th>title</th>
      <th>genre</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Toy Story (1995)</td>
      <td>Animation|Children's|Comedy</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Jumanji (1995)</td>
      <td>Adventure|Children's|Fantasy</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Grumpier Old Men (1995)</td>
      <td>Comedy|Romance</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Waiting to Exhale (1995)</td>
      <td>Comedy|Drama</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Father of the Bride Part II (1995)</td>
      <td>Comedy</td>
    </tr>
  </tbody>
</table>
</div>




```python
user_data.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>gender</th>
      <th>age</th>
      <th>occupation</th>
      <th>zipcode</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>F</td>
      <td>1</td>
      <td>10</td>
      <td>48067</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>M</td>
      <td>56</td>
      <td>16</td>
      <td>70072</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>M</td>
      <td>25</td>
      <td>15</td>
      <td>55117</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>M</td>
      <td>45</td>
      <td>7</td>
      <td>02460</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>M</td>
      <td>25</td>
      <td>20</td>
      <td>55455</td>
    </tr>
  </tbody>
</table>
</div>



## ë¶„ì„ : íƒìƒ‰ì  ë°ì´í„° ë¶„ì„í•˜ê¸° 

ğŸ” ë¶„ì„í•  ì˜í™”ì˜ ì •ë³´ íƒìƒ‰í•˜ê¸° 


```python
# ì´ ì˜í™”ì˜ ê°œìˆ˜ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤. 
print("total numver of movie in data :", len(movie_data['movie_id'].unique()))

# ì—°ë„ë³„ ì˜í™” ê°œìˆ˜ê°€ ë§ì€ Top 10 ì—°ë„ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤. 
movie_data['year'] = movie_data['title'].apply(lambda x : x[-5 : -1])
movie_data['year'].value_counts().head(10)
```

    total numver of movie in data : 3883
    




    year
    1996    345
    1995    342
    1998    337
    1997    315
    1999    283
    1994    257
    1993    165
    2000    156
    1986    104
    1992    102
    Name: count, dtype: int64



ğŸ” ì¥ë¥´ì˜ ì†ì„± íƒìƒ‰í•˜ê¸° 


```python
# ê°€ì¥ ë§ì´ ë“±ì¥í•œ ì¥ë¥´ì˜ ì†ì„±ì„ ì¶”ì¶œí•©ë‹ˆë‹¤. (ì˜ˆì‹œ : Drama)
unique_genre_dict = {}
for index, row in movie_data.iterrows() : 
    
    # genre í”¼ì²˜ë¥¼ '|' êµ¬ë¶„ìë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤. 
    genre_combination = row['genre']
    parsed_genre = genre_combination.split("|")
    # êµ¬ë¶„ìë¡œ ë¶„ë¦¬í•œ ì¥ë¥´ì˜ ì†ì„±ì„ unique_genre_dictì— ê°ê° ê³„ì‚°í•˜ì—¬ ì €ì¥í•©ë‹ˆë‹¤. 
    for genre in parsed_genre : 
        if genre in unique_genre_dict : 
            unique_genre_dict[genre] += 1
        else : 
            unique_genre_dict[genre] = 1
            
# uniqie_genre_dictë¥¼ ì´ìš©í•˜ì—¬ ì¥ë¥´ì˜ ì†ì„±ì„ ê·¸ë˜í”„ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤. 
plt.rcParams['figure.figsize'] = [20, 16]
sns.barplot(x = list(unique_genre_dict.keys()), y = list(unique_genre_dict.values()), alpha = 0.8)
plt.title('Popular genre in movies')
plt.ylabel('Count of Genre', fontsize = 12)
plt.xlabel('Genre', fontsize = 12)
plt.show()
```


    
![png](/assets/images/Book/6/output_8_0.png)
    


ğŸ” ë¶„ì„í•  ìœ ì €ì˜ ì •ë³´ íƒìƒ‰í•˜ê¸° 


```python
# ìœ ì €ì˜ ìˆ˜ë¥¼ íƒìƒ‰í•©ë‹ˆë‹¤. 
print("total number of user in data : ", len(user_data['user_id'].unique()))
```

    total number of user in data :  6040
    

ğŸ” í‰ì  ë°ì´í„°ì˜ ì •ë³´ íƒìƒ‰í•˜ê¸°


```python
# ê° ì˜í™”ê°€ í‰ê°€ë°›ì€ íšŸìˆ˜ë¥¼ íƒìƒ‰í•©ë‹ˆë‹¤. 
movie_rate_count = rating_data.groupby('movie_id')['rating'].count().values
plt.rcParams['figure.figsize'] = [8, 8]
fig = plt.hist(movie_rate_count, bins = 200)
plt.ylabel('Count', fontsize = 12)
plt.xlabel('Movie\'s rated count', fontsize = 12)
plt.show()

print("total number of movie in data :", len(movie_data['movie_id'].unique()))
print("total number of movie rated below 100 :", len(movie_rate_count[movie_rate_count < 100]))
```


    
![png](/assets/images/Book/6/output_12_0.png)
    


    total number of movie in data : 3883
    total number of movie rated below 100 : 1687
    


```python
# ì˜í™”ë³„ í‰ê·  í‰ì ì„ íƒìƒ‰í•©ë‹ˆë‹¤. 
movie_grouped_rating_info = rating_data.groupby("movie_id")["rating"].agg(['count', 'mean'])
movie_grouped_rating_info.columns = ['rated_count', 'rating_mean']
movie_grouped_rating_info['rating_mean'].hist(bins = 150, grid = False)
```




    <Axes: >




    
![png](/assets/images/Book/6/output_13_1.png)
    


ğŸ” user-movie í˜•íƒœì˜ í‘œë¡œ ì‚´í´ë³´ê¸° 


```python
# unstack() í•¨ìˆ˜ë¡œ user_id, movie_idë¥¼ ì¶•ìœ¼ë¡œ í•˜ëŠ” ë°ì´í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. 
rating_table = rating_data[['user_id', 'movie_id', 'rating']].set_index(['user_id', 'movie_id']).unstack()

# user-movie í‘œë¥¼ ì‹œê°í™”í•©ë‹ˆë‹¤. 
plt.rcParams['figure.figsize'] = [10, 10]
plt.imshow(rating_table)
plt.grid(False)
plt.xlabel("Movie")
plt.ylabel("User")
plt.title("User-movie Matrix")
plt.show()
```


    
![png](/assets/images/Book/6/output_15_0.png)
    


## ì˜ˆì¸¡ : ìˆ˜í•™ì  ê¸°ë²•ì„ í™œìš©í•´ í‰ì  ì˜ˆì¸¡í•˜ê¸°

ğŸ” MovieLens ë°ì´í„°ì˜ SVD ì ìš©í•˜ê¸° 


```python
from surprise import SVD, Dataset, Reader, accuracy 
from surprise.model_selection import train_test_split 

# SVD ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ í•™ìŠµ ë°ì´í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. 
reader = Reader(rating_scale = (1, 5))
data = Dataset.load_from_df(rating_data[['user_id', 'movie_id', 'rating']], reader)
train_data = data.build_full_trainset()

# SVD ëª¨ë¸ì„ í•™ìŠµí•©ë‹ˆë‹¤. 
train_start = time.time()
model = SVD(n_factors = 8, 
           lr_all = 0.005, 
           reg_all = 0.02, 
           n_epochs = 100)
model.fit(train_data)
train_end = time.time()
print("training time of model : %.2f seconds" % (train_end - train_start))
```

    training time of model : 35.92 seconds
    

ğŸ” ì˜í™”ì˜ ì ìˆ˜ë¥¼ ì˜ˆì¸¡í•  íƒ€ê²Ÿ ìœ ì € ì„ ì •í•˜ê¸° 


```python
# user_idê°€ 4ì¸ ìœ ì €ì˜ ì˜í™” í‰ê°€ ë°ì´í„°ì…ë‹ˆë‹¤. 
target_user_id = 4 
target_user_data = rating_data[rating_data['user_id'] == target_user_id]
target_user_data.head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_id</th>
      <th>movie_id</th>
      <th>rating</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>233</th>
      <td>4</td>
      <td>3468</td>
      <td>5</td>
      <td>978294008</td>
    </tr>
    <tr>
      <th>234</th>
      <td>4</td>
      <td>1210</td>
      <td>3</td>
      <td>978293924</td>
    </tr>
    <tr>
      <th>235</th>
      <td>4</td>
      <td>2951</td>
      <td>4</td>
      <td>978294282</td>
    </tr>
    <tr>
      <th>236</th>
      <td>4</td>
      <td>1214</td>
      <td>4</td>
      <td>978294260</td>
    </tr>
    <tr>
      <th>237</th>
      <td>4</td>
      <td>1036</td>
      <td>4</td>
      <td>978294282</td>
    </tr>
  </tbody>
</table>
</div>




```python
# user_id 4ì¸ ìœ ì €ê°€ í‰ê°€í•œ ì˜í™” íˆìŠ¤í† ë¦¬ ì •ë³´ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤. 
target_user_movie_rating_dict = {}

for index, row in target_user_data.iterrows() : 
    movie_id = row['movie_id']
    target_user_movie_rating_dict[movie_id] = row['rating']
    
print(target_user_movie_rating_dict)
```

    {3468: 5, 1210: 3, 2951: 4, 1214: 4, 1036: 4, 260: 5, 2028: 5, 480: 4, 1196: 2, 1198: 5, 1954: 5, 1097: 4, 3418: 4, 3702: 4, 2366: 4, 1387: 5, 3527: 1, 1201: 5, 2692: 5, 2947: 5, 1240: 5}
    

ğŸ” íƒ€ê²Ÿ ìœ ì €ê°€ ë³´ì§€ ì•Šì€ ì˜í™” ì¤‘, ì˜ˆìƒ í‰ì ì´ ë†’ì€ 10ê°œ ì„ ì • 


```python
# íƒ€ê²Ÿ ìœ ì €(user_idê°€ 4ì¸ ìœ ì €)ê°€ ë³´ì§€ ì•Šì€ ì˜í™” ì •ë³´ë¥¼ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ìƒì„±í•©ë‹ˆë‹¤. 
test_data = [] 
for index, row in movie_data.iterrows() : 
    movie_id = row['movie_id']
    rating = 0 
    if movie_id in target_user_movie_rating_dict : 
        continue 
    test_data.append((target_user_id, movie_id, rating))

# íƒ€ê²Ÿ ìœ ì €ì˜ í‰ì  ì ìˆ˜ë¥¼ ì˜ˆì¸¡í•©ë‹ˆë‹¤. 
target_user_predictions = model.test(test_data)

# ì˜ˆì¸¡ëœ ì ìˆ˜ ì¤‘, íƒ€ê²Ÿ ìœ ì €ì˜ ì˜í™”ë³„ ì ìˆ˜ë¥¼ target_user_movie_predict_dictë¡œ ì €ì¥í•©ë‹ˆë‹¤.
def get_user_predicted_ratings(predictions, user_id, user_history) : 
    target_user_movie_predict_dict = {}
    for uid, mid, rating, predicted_rating, _ in predictions : 
        if user_id == uid : 
            if mid not in user_history : 
                target_user_movie_predict_dict[mid] = predicted_rating 
    return target_user_movie_predict_dict

target_user_movie_predict_dict = get_user_predicted_ratings(predictions = target_user_predictions, 
                                                            user_id = target_user_id, 
                                                            user_history = target_user_movie_rating_dict) 

# target_user_movie_predict_dictì—ì„œ ì˜ˆì¸¡ëœ ì ìˆ˜ ì¤‘, íƒ€ê²Ÿ ìœ ì €ì˜ Top 10 ì˜í™”ë¥¼ ì„ ì •í•©ë‹ˆë‹¤. 
target_user_top10_predicted = sorted(target_user_movie_predict_dict.items(), 
                                     key = operator.itemgetter(1), reverse = True)[:10]
target_user_top10_predicted
```




    [(53, 5),
     (106, 5),
     (213, 5),
     (326, 5),
     (527, 5),
     (567, 5),
     (602, 5),
     (608, 5),
     (615, 5),
     (669, 5)]




```python
# íƒ€ì´í‹€ ì •ë³´ë¡œ ì¶œë ¥í•˜ê¸° ìœ„í•´ movie_idë§ˆë‹¤ movie_titleì„ ë”•ì…”ë„ˆë¦¬ í˜•íƒœë¡œ ì €ì¥í•©ë‹ˆë‹¤. 
movie_dict = {} 
for index, row in movie_data.iterrows() : 
    movie_id = row['movie_id']
    movie_title = row['title']
    movie_dict[movie_id] = movie_title 

# ì•ì„œ ê³„ì‚°í•œ Top 10 ì˜í™”ì— movie_titleì„ ë§¤í•‘í•˜ì—¬ ì¶œë ¥í•©ë‹ˆë‹¤. 
for predicted in target_user_top10_predicted : 
    movie_id = predicted[0] 
    predicted_rating = predicted[1] 
    print(movie_dict[movie_id], ":", predicted_rating) 
```

    Lamerica (1994) : 5
    Nobody Loves Me (Keiner liebt mich) (1994) : 5
    Burnt By the Sun (Utomlyonnye solntsem) (1994) : 5
    To Live (Huozhe) (1994) : 5
    Schindler's List (1993) : 5
    Kika (1993) : 5
    Great Day in Harlem, A (1994) : 5
    Fargo (1996) : 5
    Bread and Chocolate (Pane e cioccolata) (1973) : 5
    Aparajito (1956) : 5
    

## í‰ê°€ : ì˜ˆì¸¡ ëª¨ë¸ í‰ê°€í•˜ê¸° 

ğŸ” ì˜ˆì¸¡ ëª¨ë¸ì˜ í‰ê°€ ë°©ë²• 


```python
# SVD ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ í•™ìŠµ ë°ì´í„°ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. í•™ìŠµ ë°ì´í„°ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ 8:2ë¡œ ë¶„í• í•©ë‹ˆë‹¤. 
reader = Reader(rating_scale = (1, 5))
data = Dataset.load_from_df(rating_data[['user_id', 'movie_id', 'rating']], reader)
train_data, test_data = train_test_split(data, test_size = 0.2) 

# SVD ëª¨ë¸ì„ í•™ìŠµí•©ë‹ˆë‹¤. 
train_start = time.time()
model = SVD(n_factors = 8, 
            lr_all = 0.005, 
            reg_all = 0.02, 
            n_epochs = 100)
model.fit(train_data)

train_end = time.time()
print("training time of model : %.2f seconds" % (train_end - train_start))

predictions = model.test(test_data) 

# í…ŒìŠ¤íŠ¸ ë°ì´í„°ì˜ RMSEë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤. 
print("RMSE of test dataset in SVD model : ") 
accuracy.rmse(predictions)
```

    training time of model : 35.37 seconds
    RMSE of test dataset in SVD model : 
    RMSE: 0.8579
    




    0.8579217791183645



ğŸ” ì‹¤ì œ í‰ì ê³¼ì˜ ë¹„êµ ì‹œê°í™”í•˜ê¸° : í‰ì  ì˜ˆì¸¡ ë‹¨ê³„ 


```python
# íƒ€ê²Ÿ ìœ ì € ì •ë³´ë¥¼ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ìƒì„±í•©ë‹ˆë‹¤. 
test_data = [] 
for index, row in movie_data.iterrows() : 
    movie_id = row['movie_id'] 
    if movie_id in target_user_movie_rating_dict : 
        rating = target_user_movie_rating_dict[movie_id] 
        test_data.append((target_user_id, movie_id, rating))

# íƒ€ê²Ÿ ìœ ì €ì˜ í‰ì  ì ìˆ˜ë¥¼ ì˜ˆì¸¡í•©ë‹ˆë‹¤. 
target_user_predictions = model.test(test_data) 

# ì˜ˆì¸¡ëœ ì ìˆ˜ ì¤‘, íƒ€ê²Ÿ ìœ ì €ì˜ ì˜í™”ë³„ ì ìˆ˜ë¥¼ target_user_movie_predict_dictë¡œ ì €ì¥í•©ë‹ˆë‹¤. 
def get_user_predicted_ratings(predictions, user_id, user_history) : 
    target_user_movie_predict_dict = {}
    for uid, mid, rating, predicted_rating, _ in predictions : 
        if user_id == uid : 
            if mid in user_history : 
                target_user_movie_predict_dict[mid] = predicted_rating 
    return target_user_movie_predict_dict 

# target_user_movie_predict_dictì—ì„œ ì˜ˆì¸¡ëœ ì ìˆ˜ ì¤‘, íƒ€ê²Ÿ ìœ ì €ì˜ Top 10 ì˜í™”ë¥¼ ì„ ì •í•©ë‹ˆë‹¤. 
target_user_movie_predict_dict = get_user_predicted_ratings(predictions = target_user_predictions, 
                                                            user_id = target_user_id, 
                                                            user_history = target_user_movie_rating_dict)
target_user_movie_predict_dict
```




    {260: 4.06949926630174,
     480: 3.1547368162745335,
     1036: 3.9173177819285856,
     1097: 3.8957234895976542,
     1196: 3.8499120443445474,
     1198: 4.257843291054508,
     1201: 4.28077197942815,
     1210: 3.428769848333393,
     1214: 4.107145915779662,
     1240: 4.0376317242486515,
     1387: 4.180835464142906,
     1954: 3.9616284898041374,
     2028: 4.312529563561836,
     2366: 4.09078008946493,
     2692: 3.966702965097817,
     2947: 4.047970994539238,
     2951: 4.038707529050703,
     3418: 4.104852398522274,
     3468: 4.628450881589676,
     3527: 3.1283675377106412,
     3702: 3.5769088424625197}



ğŸ” ì‹¤ì œ í‰ì ê³¼ì˜ ë¹„êµ ì‹œê°í™”í•˜ê¸° 


```python
# ì˜ˆì¸¡ ì ìˆ˜ì™€ ì‹¤ì œ ì ìˆ˜ë¥¼ ì˜í™” íƒ€ì´í‹€ì— ë§¤í•‘í•©ë‹ˆë‹¤. 
origin_rating_list = [] 
predicted_rating_list = [] 
movie_title_list = [] 
idx = 0 
for movie_id, predicted_rating in target_user_movie_predict_dict.items() : 
    idx = idx + 1
    predicted_rating = round(predicted_rating, 2) 
    origin_rating = target_user_movie_rating_dict[movie_id] 
    movie_title = movie_dict[movie_id]
    print("movie", str(idx), ":", movie_title, "-", origin_rating, "/", predicted_rating) 
    origin_rating_list.append(origin_rating) 
    predicted_rating_list.append(predicted_rating) 
    movie_title_list.append(str(idx))
```

    movie 1 : Star Wars: Episode IV - A New Hope (1977) - 5 / 4.07
    movie 2 : Jurassic Park (1993) - 4 / 3.15
    movie 3 : Die Hard (1988) - 4 / 3.92
    movie 4 : E.T. the Extra-Terrestrial (1982) - 4 / 3.9
    movie 5 : Star Wars: Episode V - The Empire Strikes Back (1980) - 2 / 3.85
    movie 6 : Raiders of the Lost Ark (1981) - 5 / 4.26
    movie 7 : Good, The Bad and The Ugly, The (1966) - 5 / 4.28
    movie 8 : Star Wars: Episode VI - Return of the Jedi (1983) - 3 / 3.43
    movie 9 : Alien (1979) - 4 / 4.11
    movie 10 : Terminator, The (1984) - 5 / 4.04
    movie 11 : Jaws (1975) - 5 / 4.18
    movie 12 : Rocky (1976) - 5 / 3.96
    movie 13 : Saving Private Ryan (1998) - 5 / 4.31
    movie 14 : King Kong (1933) - 4 / 4.09
    movie 15 : Run Lola Run (Lola rennt) (1998) - 5 / 3.97
    movie 16 : Goldfinger (1964) - 5 / 4.05
    movie 17 : Fistful of Dollars, A (1964) - 4 / 4.04
    movie 18 : Thelma & Louise (1991) - 4 / 4.1
    movie 19 : Hustler, The (1961) - 5 / 4.63
    movie 20 : Predator (1987) - 1 / 3.13
    movie 21 : Mad Max (1979) - 4 / 3.58
    

ğŸ” ì‹¤ì œ í‰ì ê³¼ì˜ ë¹„êµ ì‹œê°í™”í•˜ê¸° 


```python
# ì‹¤ì œ ì ìˆ˜ì™€ ì˜ˆì¸¡ ì ìˆ˜ë¥¼ ë¦¬ìŠ¤íŠ¸ë¡œ ì¶”ì¶œí•©ë‹ˆë‹¤. 
origin = origin_rating_list 
predicted = predicted_rating_list 

# ì˜í™”ì˜ ê°œìˆ˜ë§Œí¼ ë§‰ëŒ€ ê·¸ë˜í”„ì˜ index ê°œìˆ˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤. 
plt.rcParams['figure.figsize'] = (10, 6) 
index = np.arange(len(movie_title_list)) 
bar_width = 0.2 

# ì‹¤ì œ ì ìˆ˜ì™€ ì˜ˆì¸¡ ì ìˆ˜ë¥¼ bar ê·¸ë˜í”„ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤. 
rects1 = plt.bar(index, origin, bar_width, 
                 color = 'orange', 
                 label = 'Origin') 
rects2 = plt.bar(index + bar_width, predicted, bar_width, 
                 color = 'green', 
                 label = 'Predicted') 
plt.xticks(index, movie_title_list) 
plt.legend()
plt.show()
```


    
![png](/assets/images/Book/6/output_31_0.png)
    


## í‘œë¡œ ì •ë¦¬í•˜ëŠ” ë°ì´í„° ë¶„ì„ 

|ì£¼ìš” í‚¤ì›Œë“œ|í•µì‹¬ ë‚´ìš©|ì„¤ëª…|
|-|-|-|
|í–‰ë ¬ ì™„ì„±|í‰ì  ì˜ˆì¸¡ì„ ìœ„í•´ í–‰ë ¬ì˜ ë¹ˆê³µê°„ì„ ì™„ì„±í•˜ëŠ” ê²ƒ|U-I-R(User-Item-Rating) ë°ì´í„°ì…‹ì€ í–‰ë ¬ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆìœ¼ë©°, í–‰ë ¬ì˜ R(Rating)ì„ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ í–‰ë ¬ ì™„ì„±ì˜ ëª©ì ì…ë‹ˆë‹¤.|
|í–‰ë ¬ ë¶„í•´|SVDë¥¼ ì´ìš©í•œ í–‰ë ¬ ë¶„í•´|í–‰ë ¬ ë¶„í•´ë¥¼ ì—­ì´ìš©í•˜ì—¬ í–‰ë ¬ì„ ì™„ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê·¸ì¤‘, SVDë¼ëŠ” ë°©ë²•ì´ ê°€ì¥ ë„ë¦¬ ì‚¬ìš©ë©ë‹ˆë‹¤.|
|ì˜ˆìƒ í‰ì ì˜ ì •í™•ë„|í–‰ë ¬ì˜ ì˜ˆì¸¡ ìš”ì†Œ(Rating)ë¥¼ RMSEë¡œ í‰ê°€í•˜ëŠ” ë°©ë²•|ì›ë˜ì˜ í–‰ë ¬ì„ A, SVDë¡œ ìƒì„±ëœ í–‰ë ¬ì„ A'ë¼ê³  í•  ë•Œ, Aì—ì„œ ê°’ì´ ì¡´ì¬í•˜ëŠ” Ratingì˜ ê°’ë“¤ê³¼ A'ì—ì„œ ì˜ˆì¸¡ëœ Ratingì˜ ê°’ë“¤ì„ ë¹„êµí•˜ì—¬ RMSEë¥¼ ê³„ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.|
