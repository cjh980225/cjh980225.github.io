---

title: "[ì´ê²ƒì´ ë°ì´í„° ë¶„ì„ì´ë‹¤] ë¹„íŠ¸ì½”ì¸ ì‹œì„¸ ì˜ˆì¸¡í•˜ê¸°"

categories: Books&Courses

tags: [Book, ì´ê²ƒì´_ë°ì´í„°_ë¶„ì„ì´ë‹¤, pandas, visualization, analysis, time_series_analysis]

---

# ë¹„íŠ¸ì½”ì¸ ì‹œì„¸ ì˜ˆì¸¡í•˜ê¸°

## íƒìƒ‰ : ì‹œê°„ ì •ë³´ê°€ í¬í•¨ëœ ë°ì´í„° ì‚´í´ë³´ê¸°

ğŸ” **market price ë°ì´í„°ì…‹ì˜ ê¸°ë³¸ ì •ë³´ êµ¬í•˜ê¸°**


```python
# -*- coding : utf-8 -*-
%matplotlib inline 

import pandas as pd 
import numpy as np 
import matplotlib.pyplot as plt 

file_path = './data/market-price.csv'
bitcoin_df = pd.read_csv(file_path, names = ['day', 'price'])

# ê¸°ë³¸ ì •ë³´ë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤. 
print(bitcoin_df.shape)
print(bitcoin_df.info())
bitcoin_df.tail()
```

    (365, 2)
    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 365 entries, 0 to 364
    Data columns (total 2 columns):
     #   Column  Non-Null Count  Dtype  
    ---  ------  --------------  -----  
     0   day     365 non-null    object 
     1   price   365 non-null    float64
    dtypes: float64(1), object(1)
    memory usage: 5.8+ KB
    None
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>day</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>360</th>
      <td>2018-08-22 00:00:00</td>
      <td>6575.229167</td>
    </tr>
    <tr>
      <th>361</th>
      <td>2018-08-23 00:00:00</td>
      <td>6434.881667</td>
    </tr>
    <tr>
      <th>362</th>
      <td>2018-08-24 00:00:00</td>
      <td>6543.645714</td>
    </tr>
    <tr>
      <th>363</th>
      <td>2018-08-25 00:00:00</td>
      <td>6719.429231</td>
    </tr>
    <tr>
      <th>364</th>
      <td>2018-08-26 00:00:00</td>
      <td>6673.274167</td>
    </tr>
  </tbody>
</table>
</div>




```python
# to_datetimeìœ¼ë¡œ day í”¼ì²˜ë¥¼ ì‹œê³„ì—´ í”¼ì²˜ë¡œ ë³€í™˜í•©ë‹ˆë‹¤. 
bitcoin_df['day'] = pd.to_datetime(bitcoin_df['day'])

# day ë°ì´í„° í”„ë ˆì„ì˜ indexë¡œ ì„¤ì •í•©ë‹ˆë‹¤. 
bitcoin_df.index = bitcoin_df['day']
bitcoin_df.set_index('day', inplace = True)

# ì¼ìë³„ ë¹„íŠ¸ì½”ì¸ ì‹œì„¸ë¥¼ ì‹œê°í™”í•©ë‹ˆë‹¤. 
bitcoin_df.plot()
plt.show()
```


    
![png](/assets/images/Book/5/output_2_0.png)
    


## ì˜ˆì¸¡ : íŒŒì´ì¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•´ ì‹œì„¸ ì˜ˆì¸¡í•˜ê¸°

ğŸ” **ARIMA ëª¨ë¸ í™œìš©í•˜ê¸° : ëª¨ë¸ í•™ìŠµ**


```python
from statsmodels.tsa.arima.model import ARIMA
import statsmodels.api as sm

# (AR = 2, ì°¨ë¶„ = 1, MA = 2) íŒŒë¼ë¯¸í„°ë¡œ ARIMA ëª¨ë¸ì„ í•™ìŠµí•©ë‹ˆë‹¤. 
model = ARIMA(bitcoin_df['price'].values, order=(2, 1, 2))
model_fit = model.fit()
print(model_fit.summary())
```

    C:\python_basic\Dacon\lib\site-packages\statsmodels\tsa\statespace\sarimax.py:966: UserWarning: Non-stationary starting autoregressive parameters found. Using zeros as starting parameters.
      warn('Non-stationary starting autoregressive parameters'
    C:\python_basic\Dacon\lib\site-packages\statsmodels\tsa\statespace\sarimax.py:978: UserWarning: Non-invertible starting MA parameters found. Using zeros as starting parameters.
      warn('Non-invertible starting MA parameters found.'
    

                                   SARIMAX Results                                
    ==============================================================================
    Dep. Variable:                      y   No. Observations:                  365
    Model:                 ARIMA(2, 1, 2)   Log Likelihood               -2787.490
    Date:                Tue, 13 May 2025   AIC                           5584.980
    Time:                        16:18:09   BIC                           5604.466
    Sample:                             0   HQIC                          5592.725
                                    - 365                                         
    Covariance Type:                  opg                                         
    ==============================================================================
                     coef    std err          z      P>|z|      [0.025      0.975]
    ------------------------------------------------------------------------------
    ar.L1          0.2418      0.305      0.793      0.428      -0.356       0.839
    ar.L2          0.6071      0.200      3.036      0.002       0.215       0.999
    ma.L1         -0.1513      0.306     -0.494      0.621      -0.751       0.449
    ma.L2         -0.6704      0.205     -3.276      0.001      -1.072      -0.269
    sigma2      2.624e+05   1.05e+04     24.899      0.000    2.42e+05    2.83e+05
    ===================================================================================
    Ljung-Box (L1) (Q):                   0.07   Jarque-Bera (JB):               721.97
    Prob(Q):                              0.79   Prob(JB):                         0.00
    Heteroskedasticity (H):               0.14   Skew:                             0.01
    Prob(H) (two-sided):                  0.00   Kurtosis:                         9.90
    ===================================================================================
    
    Warnings:
    [1] Covariance matrix calculated using the outer product of gradients (complex-step).
    

ğŸ” **ARIMA ë¶„ì„ì˜ íŒŒë¼ë¯¸í„°**

â–ª ì˜ˆì œì˜ ë¶„ì„ ê²°ê³¼ì™€ëŠ” ë³„ê°œë¡œ order íŒŒë¼ë¯¸í„° p, d, qëŠ” ì¼ë°˜ì ì¸ ê°€ì´ë“œë¼ì¸ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ë³´í†µì€ pì™€ qì˜ í•©ì´ 2 ë¯¸ë§Œì¸ ê²½ìš°, í˜¹ì€ pì™€ qì˜ ê³±ì´ 0ì„ í¬í•¨í•œ ì§ìˆ˜ì¸ ê²½ìš°ê°€ ì¢‹ì€ íŒŒë¼ë¯¸í„°ì˜ ì¡°í•©ì´ë¼ê³  ì•Œë ¤ì ¸ ìˆìŠµë‹ˆë‹¤. 

ğŸ” **ARIMA ëª¨ë¸ í™œìš©í•˜ê¸° : ëª¨ë¸ì˜ ì„±ëŠ¥ & ì˜ˆì¸¡ ê²°ê³¼ ì‹œê°í™”**


```python
import matplotlib.pyplot as plt
import matplotlib.font_manager as fm
import platform

# ìœˆë„ìš°ìš© í•œê¸€ í°íŠ¸ ì„¤ì •
if platform.system() == 'Windows':
    plt.rcParams['font.family'] = 'Malgun Gothic'  # ë˜ëŠ” 'ë§‘ì€ ê³ ë”•'

# ë§ˆì´ë„ˆìŠ¤ ê¸°í˜¸ ê¹¨ì§ ë°©ì§€
plt.rcParams['axes.unicode_minus'] = False
```


```python
# í•™ìŠµ êµ¬ê°„ ì „ì²´ì— ëŒ€í•´ ì˜ˆì¸¡ (ì‹œì‘: 0, ë: ì „ì²´ ê¸¸ì´ - 1)
pred = model_fit.predict()

bitcoin_df['pred'] = pred
```


```python
# ì‹¤ì œ ë°ì´í„°ì™€ ì˜ˆì¸¡ê°’ì„ í•¨ê»˜ ì‹œê°í™”
plt.figure(figsize=(12, 6))
plt.plot(bitcoin_df['price'], label='ì‹¤ì œ ê°€ê²©')
plt.plot(bitcoin_df['pred'], label='ì˜ˆì¸¡ ê°€ê²©')
plt.legend()
plt.title('ARIMA ì˜ˆì¸¡ ê²°ê³¼')
plt.show()
```


    
![png](/assets/images/Book/5/output_8_0.png)
    



```python
residuals = pd.DataFrame(model_fit.resid) # ì”ì°¨ì˜ ë³€ë™ì„ ì‹œê°í™” í•©ë‹ˆë‹¤. 
residuals.plot()
```




    <Axes: >




    
![png](/assets/images/Book/5/output_9_1.png)
    


ğŸ” **ARIMA ëª¨ë¸ í™œìš©í•˜ê¸° : ì‹¤ì œ ë°ì´í„°ì™€ì˜ ë¹„êµ**


```python
forecast_result = model_fit.get_forecast(steps=5)

# ì˜ˆì¸¡ê°’

# ë§ˆì§€ë§‰ 5ì¼ì˜ ì˜ˆì¸¡ ë°ì´í„°ì…ë‹ˆë‹¤. (2018-08-27 ~ 2018-08-31)
pred_y = forecast_result.predicted_mean.tolist() 

# ì‹¤ì œê°’
test_file_path = './data/market-price-test.csv'
bitcoin_test_df = pd.read_csv(test_file_path, names = ['ds', 'y'])

# ì‹¤ì œ 5ì¼ ê°€ê²© ë°ì´í„°ì…ë‹ˆë‹¤. (2018-08-27 ~ 2018-08-31)
test_y = bitcoin_test_df.y.values

# ì‹ ë¢° êµ¬ê°„ (í•˜í•œ, ìƒí•œ)
conf_int = forecast_result.conf_int()

# ë§ˆì§€ë§‰ 5ì¼ì˜ ì˜ˆì¸¡ ë°ì´í„°ì˜ ìµœì†Œê°’ì…ë‹ˆë‹¤. 
pred_y_lower = conf_int[:, 0].tolist()

# ë§ˆì§€ë§‰ 5ì¼ì˜ ì˜ˆì¸¡ ë°ì´í„°ì˜ ìµœëŒ€ê°’ì…ë‹ˆë‹¤. 
pred_y_upper = conf_int[:, 1].tolist()
```


```python
plt.plot(pred_y, color = "gold") # ëª¨ë¸ì´ ì˜ˆì¸¡í•œ ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
plt.plot(pred_y_lower, color = "red") # ëª¨ë¸ì´ ì˜ˆì¸¡í•œ ìµœì € ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
plt.plot(pred_y_upper, color = "blue") # ëª¨ë¸ì´ ì˜ˆì¸¡í•œ ìµœê³  ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
plt.plot(test_y, color = "green") # ì‹¤ì œ ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
plt.show()
```


    
![png](/assets/images/Book/5/output_12_0.png)
    



```python
plt.plot(pred_y, color = "gold") # ëª¨ë¸ì´ ì˜ˆì¸¡í•œ ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤.  
plt.plot(test_y, color = "green") # ì‹¤ì œ ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
plt.show()
```


    
![png](/assets/images/Book/5/output_13_0.png)
    


ğŸ” **Additive ëª¨ë¸**

â–ª Additive ëª¨ë¸ì€ ì„ í˜• íšŒê·€ ë¶„ì„ì˜ ë‹¨ì ì„ ê·¹ë³µí•˜ê¸° ìœ„í•´ ê°œëŸ‰ëœ ë¶„ì„ ë°©ë²•ì˜ í•˜ë‚˜ì…ë‹ˆë‹¤. ì‹œê³„ì—´ ë¶„ì„ ì—­ì‹œ íšŒê·€ ë¶„ì„ì˜ í•œ ê°ˆë˜ì´ê¸° ë•Œë¬¸ì— íšŒê·€ ë¶„ì„ì˜ ë‹¨ì ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ íšŒê·€ ë¶„ì„ì˜ ë‹¨ì ì„ ê·¹ë³µí•˜ê¸° ìœ„í•´ ì´ ëª¨ë¸ì€ ê° í”¼ì²˜ë§ˆë‹¤ ë¹„ì„ í˜•ì  ì í•©ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ì¼ë ¨ì˜ ë°©ë²•ì„ ì ìš©í•©ë‹ˆë‹¤. 

ğŸ” **Fackbook Prophet**

â–ª fbprophet ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ë°ì´í„° í”„ë ˆì„ì˜ í”¼ì²˜ë¥¼ 'ds'ì™€ 'y'ë¡œ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  Prophetì´ë¼ëŠ” í´ë˜ìŠ¤ë¥¼ ì„ ì–¸í•œ ë’¤, fit() í•¨ìˆ˜ë¡œ ëª¨ë¸ì„ í•™ìŠµì‹œí‚µë‹ˆë‹¤. ëª¨ë¸ ìƒì„±ì— í¬í•¨ë˜ëŠ” íŒŒë¼ë¯¸í„°ì˜ ì˜ë¯¸ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤. 

    â–« seasonality_mode : ì—°ê°„, ì›”ê°„, ì£¼ê°„, ì¼ê°„ ë“±ì˜ íŠ¸ë Œë“œì„±ì„ ë°˜ì˜í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•˜ëŠ” íŒŒë¼ë¯¸í„°ì…ë‹ˆë‹¤. 
    â–« changepoint_prior_scale : íŠ¸ë Œë“œê°€ ë³€ê²½ë˜ëŠ” ë¬¸ë§¥ì„ ë°˜ì˜í•˜ëŠ” íŒŒë¼ë¯¸í„°ì…ë‹ˆë‹¤. ìˆ˜ì¹˜ê°€ ë†’ì„ìˆ˜ë¡ ëª¨ë¸ì€ ê³¼ì í•©ì— ê°€ê¹Œì›Œì§‘ë‹ˆë‹¤. 
    
ğŸ” **Facebook Prophet í™œìš©í•˜ê¸°**


```python
from prophet import Prophet

# prophetì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ í”¼ì²˜ëª…ì„ ë³€ê²½í•´ì•¼ í•©ë‹ˆë‹¤ : 'ds', 'y'
bitcoin_df = pd.read_csv(file_path, names = ['ds', 'y'])
prophet = Prophet(seasonality_mode = 'multiplicative', 
                 yearly_seasonality = True, 
                 weekly_seasonality = True, daily_seasonality = True, 
                 changepoint_prior_scale = 0.5)
prophet.fit(bitcoin_df)
```

    14:36:46 - cmdstanpy - INFO - Chain [1] start processing
    14:36:47 - cmdstanpy - INFO - Chain [1] done processing
    




    <prophet.forecaster.Prophet at 0x1fb61c94be0>




```python
# 5ì¼ì„ ë‚´ë‹¤ë³´ë©° ì˜ˆì¸¡í•©ë‹ˆë‹¤. 
future_data = prophet.make_future_dataframe(periods = 5, freq = 'd')
forecast_data = prophet.predict(future_data)
forecast_data[['ds', 'yhat', 'yhat_lower', 'yhat_upper']].tail(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ds</th>
      <th>yhat</th>
      <th>yhat_lower</th>
      <th>yhat_upper</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>365</th>
      <td>2018-08-27</td>
      <td>6978.697763</td>
      <td>6383.208900</td>
      <td>7616.038722</td>
    </tr>
    <tr>
      <th>366</th>
      <td>2018-08-28</td>
      <td>7082.561527</td>
      <td>6412.558304</td>
      <td>7802.581676</td>
    </tr>
    <tr>
      <th>367</th>
      <td>2018-08-29</td>
      <td>7111.709229</td>
      <td>6415.910817</td>
      <td>7819.612987</td>
    </tr>
    <tr>
      <th>368</th>
      <td>2018-08-30</td>
      <td>7195.310702</td>
      <td>6470.502651</td>
      <td>7951.832586</td>
    </tr>
    <tr>
      <th>369</th>
      <td>2018-08-31</td>
      <td>7278.045865</td>
      <td>6445.717598</td>
      <td>8108.385558</td>
    </tr>
  </tbody>
</table>
</div>




```python
fig1 = prophet.plot(forecast_data)
```


    
![png](/assets/images/Book/5/output_17_0.png)
    



```python
fig2 = prophet.plot_components(forecast_data)
```


    
![png](/assets/images/Book/5/output_18_0.png)
    


ğŸ” **Facebook Prophet í™œìš©í•˜ê¸° : ì‹¤ì œ ë°ì´í„°ì™€ì˜ ë¹„êµ**


```python
bitcoin_test_df = pd.read_csv(test_file_path, names = ['ds', 'y'])

# ë§ˆì§€ë§‰ 5ì¼ì˜ ì˜ˆì¸¡ ë°ì´í„°ì…ë‹ˆë‹¤. (2018-08-27 ~ 2018-08-31)
pred_y = forecast_data.yhat.values[-5 : ]

# ì‹¤ì œ 5ì¼ ê°€ê²© ë°ì´í„°ì…ë‹ˆë‹¤. (2018-08-27 ~ 2018-08-31)
test_y = bitcoin_test_df.y.values

# ë§ˆì§€ë§‰ 5ì¼ ì˜ˆì¸¡ ë°ì´í„°ì˜ ìµœì†Œê°’ì…ë‹ˆë‹¤. 
pred_y_lower = forecast_data.yhat_lower.values[-5 : ]

# ë§ˆì§€ë§‰ 5ì¼ ì˜ˆì¸¡ ë°ì´í„°ì˜ ìµœëŒ€ê°’ì…ë‹ˆë‹¤. 
pred_y_upper = forecast_data.yhat_upper.values[-5 : ]

plt.plot(pred_y, color = 'gold') # ëª¨ë¸ì´ ì˜ˆìƒí•œ ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
plt.plot(pred_y_lower, color = 'red') # ëª¨ë¸ì´ ì˜ˆìƒí•œ ìµœì € ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
plt.plot(pred_y_upper, color = 'blue') # ëª¨ë¸ì´ ì˜ˆìƒí•œ ìµœê³  ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
plt.plot(test_y, color = 'green') # ì‹¤ì œ ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
```




    [<matplotlib.lines.Line2D at 0x1fb622b1880>]




    
![png](/assets/images/Book/5/output_20_1.png)
    



```python
plt.plot(pred_y, color = 'gold') # ëª¨ë¸ì´ ì˜ˆìƒí•œ ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤.  
plt.plot(test_y, color = 'green') # ì‹¤ì œ ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
```




    [<matplotlib.lines.Line2D at 0x1fb62313310>]




    
![png](/assets/images/Book/5/output_21_1.png)
    



```python
from math import sqrt
from sklearn.metrics import mean_squared_error

rmse = sqrt(mean_squared_error(pred_y, test_y))
print(rmse)
```

    216.3664510346069
    

## í™œìš© : ë” ë‚˜ì€ ê²°ê³¼ë¥¼ ìœ„í•œ ë°©ë²• 

ğŸ” **ìƒí•œê°€ ë° í•˜í•œê°€ ì„¤ì •í•˜ê¸°**


```python
bitcoin_df = pd.read_csv(file_path, names = ['ds', 'y'])

# ìƒí•œê°€ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. 
bitcoin_df['cap'] = 20000

# ìƒí•œê°€ ì ìš©ì„ ìœ„í•œ íŒŒë¼ë¯¸í„°ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì •í•©ë‹ˆë‹¤. 
prophet = Prophet(seasonality_mode = 'multiplicative', 
                 growth = 'logistic', 
                 yearly_seasonality = True, 
                 weekly_seasonality = True, daily_seasonality = True, 
                 changepoint_prior_scale = 0.5)
prophet.fit(bitcoin_df)

# 5ì¼ì„ ë‚´ë‹¤ë³´ë©° ì˜ˆì¸¡í•©ë‹ˆë‹¤. 
future_data = prophet.make_future_dataframe(periods = 5, freq = 'd')

# ìƒí•œê°€ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤. 
future_data['cap'] = 20000
forecast_data = prophet.predict(future_data)

fig = prophet.plot(forecast_data)
```

    14:49:58 - cmdstanpy - INFO - Chain [1] start processing
    14:49:58 - cmdstanpy - INFO - Chain [1] done processing
    


    
![png](/assets/images/Book/5/output_24_1.png)
    


ğŸ” **ì˜ˆì¸¡ê³¼ ì‹¤ì œ ë¹„êµ ê·¸ë˜í”„**


```python
bitcoin_test_df = pd.read_csv(test_file_path, names = ['ds', 'y'])

# ëª¨ë¸ì´ ì˜ˆì¸¡í•œ ë§ˆì§€ë§‰ 5ì¼ì˜ ê°€ê²© ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. 
pred_y = forecast_data.yhat.values[-5 : ]
test_y = bitcoin_test_df.y.values 
pred_y_lower = forecast_data.yhat_lower.values[-5 : ]
pred_y_upper = forecast_data.yhat_upper.values[-5 : ]

plt.plot(pred_y, color = 'gold') # ëª¨ë¸ì´ ì˜ˆì¸¡í•œ ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
plt.plot(pred_y_lower, color = 'red') # ëª¨ë¸ì´ ì˜ˆì¸¡í•œ í•˜í•œê°€ ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
plt.plot(pred_y_upper, color = 'blue') # ëª¨ë¸ì´ ì˜ˆì¸¡í•œ ìƒí•œê°€ ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
plt.plot(test_y, color = 'green') # ì‹¤ì œ ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
```




    [<matplotlib.lines.Line2D at 0x1fb62c78760>]




    
![png](/assets/images/Book/5/output_26_1.png)
    


ğŸ” **ì´ìƒì¹˜ ì œê±°í•˜ê¸°**


```python
# 18,000 ì´ìƒì˜ ë°ì´í„°ëŠ” ì´ìƒì¹˜ë¼ê³  íŒë‹¨í•©ë‹ˆë‹¤. 
bitcoin_df = pd.read_csv(file_path, names = ['ds', 'y'])
bitcoin_df.loc[bitcoin_df['y'] > 18000, 'y'] = None 

# prophet ëª¨ë¸ì„ í•™ìŠµí•©ë‹ˆë‹¤. 
prophet = Prophet(seasonality_mode = 'multiplicative', 
                 yearly_seasonality = True, 
                 weekly_seasonality = True, daily_seasonality = True, 
                 changepoint_prior_scale = 0.5)
prophet.fit(bitcoin_df)

# 5ì¼ ë‹¨ìœ„ì˜ ë¯¸ë˜ë¥¼ ì˜ˆì¸¡í•©ë‹ˆë‹¤. 
future_data = prophet.make_future_dataframe(periods = 5, freq = 'd')
forecast_data = prophet.predict(future_data)

# ì˜ˆì¸¡ ê²°ê³¼ë¥¼ ê·¸ë˜í”„ë¡œ ì¶œë ¥í•©ë‹ˆë‹¤. 
fig = prophet.plot(forecast_data)
```

    14:56:04 - cmdstanpy - INFO - Chain [1] start processing
    14:56:04 - cmdstanpy - INFO - Chain [1] done processing
    


    
![png](/assets/images/Book/5/output_28_1.png)
    



```python
plt.plot(pred_y, color = 'gold') # ëª¨ë¸ì´ ì˜ˆì¸¡í•œ ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 
plt.plot(test_y, color = 'green') # ì‹¤ì œ ê°€ê²© ê·¸ë˜í”„ì…ë‹ˆë‹¤. 

# í…ŒìŠ¤íŠ¸ ë°ì´í„°ì˜ RMSEë¥¼ ì¶œë ¥í•©ë‹ˆë‹¤. 
rmse = sqrt(mean_squared_error(pred_y, test_y))
print(rmse)
```

    916.5468395957105
    


    
![png](/assets/images/Book/5/output_29_1.png)
    


## í‘œë¡œ ì •ë¦¬í•˜ëŠ” ë°ì´í„° ë¶„ì„ 

|ì£¼ìš” í‚¤ì›Œë“œ|í•µì‹¬ ë‚´ìš©|ì„¤ëª…|
|-|-|-|
|ì‹œê³„ì—´ ë°ì´í„° ë¶„ì„|ì‹œê³„ì—´ ë°ì´í„° ë¶„ì„ì˜ ì •ì˜|ì—°ë„, ì›”, ì¼ì ê°™ì€ ì‹œê°„ì„±ì„ ë ëŠ” ë°ì´í„°ë¥¼ í•™ìŠµí•˜ì—¬ ë¯¸ë˜ì˜ ìˆ˜ì¹˜ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ë¶„ì„ì…ë‹ˆë‹¤.|
|ARIMA ëª¨ë¸ë§|ì‹œê³„ì—´ ì˜ˆì¸¡ ë¶„ì„ ë°©ë²•|ARIMA ëª¨ë¸ì€ 'ì–¼ë§ˆë§Œí¼ì˜ ë‚˜ë¥¼ ëŒì•„ë³´ë©°', 'ì–¼ë§ˆë§Œí¼ì˜ ì°¨ë¶„ì„ ì´ìš©í•˜ì—¬ ê·œì¹™ì„±ì„ ì¤„ ê²ƒì´ë©°', 'ì–¼ë§ˆë§Œí¼ì˜ ì˜¤ì°¨ë¥¼ ê´€ì°°í•  ê²ƒì¸ì§€'ë¥¼ í™œìš©í•œ ì‹œê³„ì—´ ì˜ˆì¸¡ ë¶„ì„ì˜ ë°©ë²•ì…ë‹ˆë‹¤.|
|ëª¨ë¸ì˜ í‰ê°€|í•™ìŠµ ë°ì´í„°ì…‹ê³¼ í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ì˜ ë¶„ë¦¬|íŠ¹ì •í•œ ì‹œê°„ í˜¹ì€ ì¼ìë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•™ìŠµ ë°ì´í„°ì…‹ê³¼ í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…‹ì„ ë¶„ë¦¬í•©ë‹ˆë‹¤.|
|ëª¨ë¸ ê°œì„ ì˜ ë°©ë²•|ìƒí•œì„ ê³¼ í•˜í•œì„  ê²°ì •, ì´ìƒì¹˜ ì œê±°|ë” ë‚˜ì€ ë¶„ì„ì„ ìœ„í•´ ìƒí•œì„ ê³¼ í•˜í•œì„ ì„ ì„¤ì •í•˜ê±°ë‚˜ ì´ìƒì¹˜ë¥¼ ì œê±°í•˜ëŠ” ë°©ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.|


```python

```
